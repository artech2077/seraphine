# Story 0.1: GitHub & Vercel Project Bootstrap

## Status
In Progress

## Story
**As a** founding engineer,
**I want** to bootstrap the GitHub and Vercel project foundations with CI,
**so that** the team can collaborate with protected workflows from day one.

## Acceptance Criteria
1. Establish the GitHub repository with branch protections and default CODEOWNERS.
2. Link the repo to a Vercel project using the autogenerated Vercel domain (no custom domain).
3. Configure GitHub Actions CI pipeline to run lint, unit tests, and Playwright smoke checks on every pull request.

## Tasks / Subtasks
- [ ] Task 1 (AC: 1) Initialize repository governance and structure
  - [x] Scaffold the monorepo directories (`apps/`, `packages/`, `tooling/`, `.github/`) and baseline files so the repo matches the documented source tree. [Source: docs/architecture.md#repository-structure]
  - [ ] Add default CODEOWNERS and enforce branch protection rules on `main`, fulfilling the PRD requirement because the architecture docs provide no additional guidance. [Source: prd/epics-user-stories.md#story-01-github-vercel-project-bootstrap]
  - [x] Populate `.env.example`, `pnpm-workspace.yaml`, `turbo.json`, and root `package.json` placeholders ready for downstream stories. [Source: docs/architecture.md#repository-structure]
- [ ] Task 2 (AC: 2) Connect GitHub repository to Vercel hosting
  - [ ] Create the Vercel project from the GitHub repository and confirm preview/production environments use the autogenerated `seraphine*.vercel.app` domains. [Source: docs/architecture.md#deployment-strategy]
  - [ ] Configure required environment variables in Vercel (Clerk, Convex, n8n, analytics) and mirror them via `.env` templates without committing secrets. [Source: docs/architecture.md#environment-configuration]
  - [ ] Set up Vercel and Convex webhook URLs for preview deploys to support automated environment refreshes. [Source: docs/architecture.md#deployment-architecture]
- [x] Task 3 (AC: 3) Implement continuous integration safeguards
  - [x] Add `.github/workflows/ci.yml` running pnpm install, lint, unit tests, and Playwright suites per the documented pipeline. [Source: docs/architecture.md#deployment-architecture]
  - [x] Ensure CI uses Node 20 with pnpm caching and blocks merges unless checks succeed on `main` pull requests. [Source: docs/architecture.md#deployment-architecture]
  - [x] Verify pipeline commands (`pnpm lint`, `pnpm test`, `pnpm test:e2e`) align with the standard development scripts. [Source: docs/architecture.md#development-commands]

## Dev Notes
### Previous Story Insights
No prior stories have been implemented; there are no historical learnings to apply.

### Repository Foundations
- The architecture mandates a pnpm monorepo with `apps/web`, shared `packages`, tooling directories, and `.github/workflows` housing CI definitions; these structures must exist from the initial commit. [Source: docs/architecture.md#repository-structure]
- Baseline setup includes root configuration files (`package.json`, `pnpm-workspace.yaml`, `turbo.json`, `.env.example`) so future stories inherit the expected workspace behavior. [Source: docs/architecture.md#repository-structure]
- Architecture documentation does not prescribe explicit branch protection defaults; the PRD mandates branch protections, so configure at least one approving review and require the `ci` workflow to pass on `main` to satisfy the baseline guardrails, then confirm with stakeholders if stricter rules are needed. [Source: prd/epics-user-stories.md#story-01-github-vercel-project-bootstrap]

### Vercel Integration
- Vercel hosts the Next.js App Router frontend with builds triggered via `pnpm turbo run build --filter=web`, relying on managed preview and production domains (`seraphine*.vercel.app`). [Source: docs/architecture.md#deployment-strategy]
- Deployment workflows depend on preview deploy hooks that also notify Convex environments after CI success; configure webhook secrets and URLs during Vercel linking. [Source: docs/architecture.md#deployment-architecture]
- Autogenerated domains are acceptable for the pilot; custom domains are deferred until later phases per deployment guidance. [Source: docs/architecture.md#deployment-strategy]

### CI/CD Expectations
- The canonical GitHub Actions workflow installs pnpm 9 with Node 20, runs `pnpm install --frozen-lockfile`, then executes `pnpm lint`, `pnpm test`, and `pnpm test:e2e -- --reporter=list --headed=false` before triggering Vercel/Convex preview hooks. [Source: docs/architecture.md#deployment-architecture]
- CI must execute on every pull request to `main`, gating merges until linting and tests succeed; use provided environment hook URLs to coordinate preview deployments. [Source: docs/architecture.md#deployment-architecture]
- Local developer commands mirror the CI scripts, so ensuring script parity in `package.json` avoids drift across environments. [Source: docs/architecture.md#development-commands]

### Environment & Secret Management
- `.env.example` should enumerate required variables (Clerk keys, Convex deployment URL, Vercel analytics token, webhook secrets) while keeping actual values in Vercel/Convex secret stores and 1Password vaults. [Source: docs/architecture.md#environment-configuration]
- Sensitive keys must never be committed; distribute via managed platforms and ensure Doppler/1Password processes handle long-term storage. [Source: docs/architecture.md#security-and-performance]

### Project Structure Notes
- Current repository contains documentation only; implementing this story requires creating the monorepo directories and configuration files described in the architecture source tree. [Source: docs/architecture.md#repository-structure]

### Testing
- Vitest and Playwright are the mandated frameworks; unit and integration tests run via `pnpm test`, while Playwright smoke checks execute with `pnpm test:e2e`. [Source: docs/architecture.md#development-commands]
- CI replicates the local testing strategy, so ensure new workflows call the documented scripts without custom flags beyond the standard reporters. [Source: docs/architecture.md#deployment-architecture]
- Accessibility and additional suites (`pnpm test:a11y`) are introduced in later stories; keep placeholders prepared for future pipeline expansion. [Source: docs/architecture.md#development-commands]

## Change Log
| Date       | Version | Description          | Author        |
|------------|---------|----------------------|---------------|
| 2025-10-29 | 0.1     | Initial draft created | Scrum Master |

## Dev Agent Record
### Agent Model Used
- GPT-5 Codex (developer)

### Debug Log References
- docs/governance/branch-protection.md â€” manual policy outline pending GitHub settings update
- External systems: GitHub repo settings & Vercel dashboard require human action for linking and secrets

### Completion Notes List
- Scaffolding for apps, packages, tooling, scripts, and governance docs aligns repo with architecture source tree.
- Added workspace configuration (`package.json`, `pnpm-workspace.yaml`, `turbo.json`, `.env.example`) to support pnpm/turbo pipeline.
- Declared Node 20.10.0 engine and pinned pnpm 9.12.1 so Vercel and CI run with the supported toolchain.
- Implemented GitHub Actions `ci` workflow covering lint, unit, and Playwright commands with Node 20 + pnpm caching.
- Unable to enforce `main` branch protection or connect to Vercel from this environment; documented required follow-up steps.

### File List
- .env.example
- .gitignore
- .github/CODEOWNERS
- .github/workflows/ci.yml
- README.md
- apps/web/app/.gitkeep
- apps/web/components/.gitkeep
- apps/web/hooks/.gitkeep
- apps/web/lib/.gitkeep
- apps/web/modules/.gitkeep
- apps/web/package.json
- apps/web/public/.gitkeep
- apps/web/stores/.gitkeep
- apps/web/styles/.gitkeep
- apps/web/tests/.gitkeep
- docs/governance/branch-protection.md
- package.json
- packages/config/.gitkeep
- packages/config/package.json
- packages/convex/.gitkeep
- packages/convex/package.json
- packages/shared/.gitkeep
- packages/shared/package.json
- packages/ui/.gitkeep
- packages/ui/package.json
- pnpm-workspace.yaml
- scripts/.gitkeep
- tooling/eslint-config/.gitkeep
- tooling/eslint-config/package.json
- tooling/playwright/.gitkeep
- tooling/playwright/package.json
- turbo.json
- docs/stories/0.1.github-vercel-project-bootstrap.md

## QA Results
